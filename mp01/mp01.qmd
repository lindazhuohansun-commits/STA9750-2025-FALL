---
title: "Exploring the Most Popular Programming on Netflix"
author: "Zhuohan Sun"
format:
  html:
    theme: journal
    toc: true
    toc-depth: 3
    code-fold: true
    code-summary: "Show code"
    embed-resources: true
    
---
# Introduction

Netflix is one of the world’s leading streaming platforms, recognized for its broad slate of films and series. Using Netflix Top 10 data, we analyze which titles break out and how popularity differs across countries. The goal is to pinpoint markets with outsized demand and identify where targeted commissioning, localization, and marketing can unlock stronger traffic and growth. This report highlights the regions and countries most likely to become Netflix’s next growth engines.

# Acquire Data
```{r}
if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}
```


# Data Import and Preparation
## GLOBAL_TOP_10
```{r}
if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME)
```

```{r}
glimpse(GLOBAL_TOP_10)
```

```{r}
GLOBAL_TOP_10 <- GLOBAL_TOP_10 |>
    mutate(season_title = if_else(season_title == "N/A", NA_character_, season_title))
```

```{r}
glimpse(GLOBAL_TOP_10)
```
## COUNTRY_TOP_10
```{r}
if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)

COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME)
```

```{r}
glimpse(COUNTRY_TOP_10)
```

```{r}
COUNTRY_TOP_10 <- COUNTRY_TOP_10 |>
    mutate(season_title = if_else(season_title == "N/A", NA_character_, season_title))
```

```{r}
glimpse(COUNTRY_TOP_10)
```
3.# Initial Data Exploration
```{r}
library(DT)
GLOBAL_TOP_10 |> 
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE))
```

```{r}
library(stringr)
format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

GLOBAL_TOP_10 |> 
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

```{r}
GLOBAL_TOP_10 |> 
    select(-season_title) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

```{r}
GLOBAL_TOP_10 |> 
    mutate(`runtime_(minutes)` = round(60 * runtime)) |>
    select(-season_title, 
           -runtime) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```
# Exploratory Questions

## Q1. How many different countries does Netflix operate in? (You can use the viewing history as a proxy for countries in which Netflix operates.)
```{r}
Country_rseach <- COUNTRY_TOP_10 |>
  distinct(country_name) |>
  count()
```

Based on Netflix’s per-country viewing-history dataset, Netflix operates in
**`r Country_rseach`** different countries/territories.

## Q2. Which non-English-language film has spent the most cumulative weeks in the global top 10? How many weeks did it spend?
```{r}
top_row <- GLOBAL_TOP_10 |>
  filter(category == "Films (Non-English)") |>
  group_by(show_title) |>
  summarise(weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE), .groups = "drop") |>
  slice_max(weeks, n = 1, with_ties = FALSE)
```

The non-English-language film that has spent the most cumulative weeks in the global Top 10 is
**`r top_row`** weeks.

## Q3. What is the longest film (English or non-English) to have ever appeared in the Netflix global Top 10? How long is it in minutes?
```{r}
longest_film_title <- GLOBAL_TOP_10 |>
  filter(category %in% c("Films (English)", "Films (Non-English)")) |>
  mutate(runtime_minutes = round(60 * runtime)) |>
  filter(!is.na(runtime_minutes)) |>
  slice_max(runtime_minutes, n = 1)

datatable(
  longest_film_title[, c("show_title", "runtime_minutes")],
  rownames = FALSE,
  options = list(searching = FALSE, info = FALSE, dom = "t"),
  caption = htmltools::tags$caption(
    style = 'caption-side: bottom; text-align: left; font-weight: bold;',
    'Table 1: Longest Film Appeared in Netflix Global Top 10'
  )
)
```

The longest film is **`r longest_film_title$show_title[1]`**,**`r longest_film_title$runtime_minutes[1]`** minutes.


## Q4. For each of the four categories, what program has the most total hours of global viewership?
```{r}
Top_program_categories <- GLOBAL_TOP_10 |>
  group_by(category, show_title) |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE), .groups = "drop") |>
  group_by(category) |>
  slice_max(total_hours, n = 1, with_ties = FALSE) |>
  ungroup() |>
  arrange(desc(total_hours))

datatable(
  Top_program_categories,
  options = list(searching = FALSE, info = FALSE),
  caption = htmltools::tags$caption(
    style = 'caption-side: bottom; text-align: left; font-weight: bold;',
    'Table 2: Top Program by Category (Total Hours Viewed)'
  )
)
```


## Q5. Which TV show had the longest run in a country’s Top 10? How long was this run and in what country did it occur?
```{r}
longest_run_tv <- COUNTRY_TOP_10 |>
  filter(category == "TV") |>
  group_by(country_name, show_title) |>
  summarise(total_weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE), .groups = "drop") |>
  group_by(country_name) |>
  slice_max(total_weeks, n = 1, with_ties = FALSE) |>
  ungroup() |>
  arrange(desc(total_weeks))

datatable(
  longest_run_tv,
  rownames = FALSE,
  options = list(pageLength = 10, searching = FALSE, info = FALSE, dom = "t"),
  caption = htmltools::tags$caption(
    style = 'caption-side: bottom; text-align: left; font-weight: bold;',
    'Table 3: Longest-Running TV Shows in a Country’s Netflix Top 10'
  )
) |>
  formatStyle( 0, target = "row", backgroundColor = styleRow(1, "lightcoral"), color = styleRow(1, "white"), fontWeight = styleRow(1, "bold") )

```

The longest-running TV show in the top 10 is **`r longest_run_tv$show_title[1]`**, which aired in **`r longest_run_tv$country_name[1]`** for **`r longest_run_tv$total_weeks[1]`** weeks.

## Q6. Netflix provides over 200 weeks of service history for all but one country in our data set. Which country is this and when did Netflix cease operations in that country?
```{r}
short_service_country <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(total_weeks = n_distinct(week), .groups = "drop") |>
  filter(total_weeks < 200) |>
  arrange(total_weeks)
 
cease_date <- COUNTRY_TOP_10 |>
  filter(country_name == short_service_country$country_name[1]) |>
  summarise(last_week = max(week))
```

The country is **`r short_service_country$country_name[1]`**.According to the dataset, Netflix ceased operations there in **`r cease_date$last_week`**.

## Q7. What is the total viewership of the TV show Squid Game? Note that there are three seasons total and we are looking for the total number of hours watched across all seasons.
```{r}
squid_game_total <- GLOBAL_TOP_10 |>
  filter(str_detect(show_title, "Squid Game")) |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE))
```

The total viewership of the TV show Squid Game is **`r format(squid_game_total$total_hours, scientific = FALSE)`**hours.

## Q8. The movie Red Notice has a runtime of 1 hour and 58 minutes. Approximately how many views did it receive in 2021? 

Note that Netflix does not provide the weekly_views values that far back in the past, but you can compute it yourself using the total view time and the runtime.
```{r}
red_notice_views <- GLOBAL_TOP_10 |>
  filter(show_title == "Red Notice", year(week) == 2021) |>
  mutate(approx_views = weekly_hours_viewed / (1 + 58 / 60)) |>
  summarise(show_title = "Red Notice", total_views = sum(approx_views, na.rm = TRUE))
    
datatable(red_notice_views, 
  options = list(searching = FALSE, info = FALSE), 
  caption = htmltools::tags$caption(
    style = 'caption-side: bottom; text-align: left; font-weight: bold;',
    'Table 4: Approximate Views of Red Notice in 2021' ))
```

The movie *Red Notice* received approximately **`r format(red_notice_views$total_views, scientific = FALSE)`** views in 2021.

## Q9. How many Films reached Number 1 in the US but did not originally debut there? That is, find films that first appeared on the Top 10 chart at, e.g., Number 4 but then became more popular and eventually hit Number 1? What is the most recent film to pull this off?

```{r}
 us_climbers <- COUNTRY_TOP_10 |>
  filter(country_name == "United States", str_detect(category, "Films")) |>
  group_by(show_title) |>
  summarise(
    debut_week = min(week, na.rm = TRUE),
    debut_rank = weekly_rank[which.min(week)],     
    best_rank = min(weekly_rank, na.rm = TRUE),    
    last_week_at_1 = if (any(weekly_rank == 1)) max(week[weekly_rank == 1]) else as.Date(NA),
    .groups = "drop") |>
  filter(debut_rank > 1, best_rank == 1) |>
  arrange(desc(last_week_at_1))

datatable(
  us_climbers,
  rownames = FALSE,
  options = list(pageLength = 10, searching = FALSE, info = FALSE, dom = "t"),
  caption = htmltools::tags$caption(
    style = 'caption-side: bottom; text-align: left; font-weight: bold;',
    'Table 5: US Films that Debuted Below #1 but Later Reached #1')) |>
 formatStyle( 0, target = "row", backgroundColor = styleRow(1, "lightcoral"), color = styleRow(1, "white"), fontWeight = styleRow(1, "bold") ) 
```
```{r}
total_films <- nrow(us_climbers)
most_recent <- us_climbers |> slice(1)

```

In total, **`r total_films`** films in the US Top 10 debuted below #1 but eventually reached #1.The most recent film to achieve this was **`r most_recent$show_title`**, which hit #1 on **`r most_recent$last_week_at_1`**.

## Q10. Which TV show/season hit the top 10 in the most countries in its debut week? In how many countries did it chart?
```{r}
debut_top_ten <- COUNTRY_TOP_10 |>
  filter(category == "TV") |>
  group_by(show_title, season_title) |>
  mutate(debut_week = min(week, na.rm = TRUE)) |>    #The debut week of each show     
  filter(week == debut_week) |>                      #Only keep the debut week  
  summarise(debut_countries = n_distinct(country_name), debut_week = first(debut_week),.groups = "drop") |>
  arrange(desc(debut_countries))

datatable(debut_top_ten,
 options = list(pageLength = 10, searching = FALSE, info = FALSE, dom = "t"),
  caption = htmltools::tags$caption(
    style = 'caption-side: bottom; text-align: left; font-weight: bold;',
    'Table 6: TV Shows with the Widest Debut (Number of Countries in First Week)' )) |>
  formatStyle( 0, target = "row", backgroundColor = styleRow(1, "lightcoral"), color = styleRow(1, "white"), fontWeight = styleRow(1, "bold") )

```

**`r debut_top_ten$show_title[1]`** hit the Top 10 in the most countries in its debut week, charting in **`r debut_top_ten$debut_countries[1]`** countries.

# Preparing Releases
## Stranger Things Finale Poised to Make a Powerful Global Debut

 
```{r}
st_global <- GLOBAL_TOP_10 |>
  filter(str_detect(show_title, "Stranger Things"))

st_country <- COUNTRY_TOP_10 |>
  filter(str_detect(show_title, "Stranger Things"))

st_total_hours <- st_global |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE)) |>
   pull(total_hours)

st_total_weeks <- st_global |>
  summarise(total_weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE)) |>
  pull(total_weeks)

st_countries <- st_country |>
  summarise(total_countries = n_distinct(country_name)) |>
  pull(total_countries)

```
```{r}
populer_titles <- c("Stranger Things", "Wednesday", "Bridgerton")


comparison <- GLOBAL_TOP_10 |>
  filter(show_title %in% populer_titles) |>
  group_by(show_title) |>
  summarise(
    total_hours = sum(weekly_hours_viewed, na.rm = TRUE),
    total_weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE),
    .groups = "drop"
  ) |>
  arrange(desc(total_hours))  


datatable(comparison,
  rownames = FALSE,
  options = list(searching = FALSE, info = FALSE, dom = "t"),
  caption = htmltools::tags$caption(
    style = 'caption-side: bottom; text-align: left; font-weight: bold;',
    'Comparison of Stranger Things, Wednesday, and Bridgerton')) |>
     formatStyle( 0, target = "row", backgroundColor = styleRow(1, "lightcoral"), color = styleRow(1, "white"), fontWeight = styleRow(1, "bold") ) 
```

Unknowingly, *Stranger Things* has accompanied us through four seasons, and Netflix is set to release its long-awaited final chapter—the fifth season—by the end of 2025. Over its first four seasons, the series has accumulated more than **`r format(st_total_hours, scientific = FALSE)`** hours of global viewership and remained on Netflix’s Global Top 10 list for over **`r st_total_weeks`** weeks. With its broad appeal, the show has reached audiences in **`r st_countries`** countries, making it one of the most internationally recognized English-language TV series on the platform.In contrast to other popular titles like *Wednesday* and *Bridgerton*, Stranger Things has distinguished itself not only through multiple blockbuster installments, but also through its enduring capacity to capture worldwide attention season after season.Audiences worldwide now look forward to the series delivering a fitting and unforgettable conclusion.


##  Netflix has established a firm foothold in the Indian market through its distinctive local content

```{r}
us_films <- COUNTRY_TOP_10 |>
  filter(country_name == "United States", category == "Films" ) |>
  group_by(show_title) |>
  summarize(weeks_in_us = n())
 
india_films <- COUNTRY_TOP_10 |>
  filter(country_name == "India", category == "Films" ) |>
  group_by(show_title) |>
  summarize(weeks_in_india = n()) |>
  arrange(desc(weeks_in_india))

hindi_films <- india_films |>
  filter(!show_title %in% us_films$show_title) |>
  arrange(desc(weeks_in_india))

top_five_hindi <- india_films [1:5, ]
india_market <- COUNTRY_TOP_10 |>
  filter(country_name == "India", category == "Films") |>
  summarize(total_films_in_india = n(),
            hindi_films_count = sum(show_title %in% hindi_films$show_title),
            hindi_market = (hindi_films_count / total_films_in_india) * 100)

top_five_list <- paste(top_five_hindi$show_title, collapse = ", ")

hindi_share_pct <- round(india_market$hindi_market, 1)

```

Netflix has achieved record-breaking success in India, underscoring the rising popularity of Hindi-language films. As the most populated country in the world, India represents Netflix’s greatest long-term growth opportunity. Recent data shows that localized Hindi content has boosted user engagement and reinforced Netflix’s market position in India. Hindi-language films account for approximately **`r hindi_share_pct`%** of all films in India’s Top 10, with standout titles including **`r top_five_list`**. The Indian film market continues to demonstrate an upward trajectory, with the number of Hindi films entering India’s Top 10 steadily increasing week by week—highlighting the growing importance of localized storytelling.

```{r}
us_films <- COUNTRY_TOP_10 %>%
  filter(country_name == "United States", category == "Films") %>%
  distinct(show_title)


india_films <- COUNTRY_TOP_10 %>%
  filter(country_name == "India", category == "Films")

hindi_films <- india_films %>%
  filter(!show_title %in% us_films$show_title)


hindi_trend <- hindi_films %>%
  group_by(week) %>%
  summarise(
    num_films = n_distinct(show_title),   
    .groups = "drop"
  ) %>%
  arrange(week)

ggplot(hindi_trend, aes(x = week, y = num_films)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "darkred") +
  labs(
    title = "Growth Trend of Hindi Films in India Top 10",
    x = "Week",
    y = "Number of Hindi Films in Top 10" ) + theme_minimal()

```


## Netflix’s footprint in Argentina shines

```{r}
# Analyze the playback volume of the top three videos in the region with the longest playback time.
long_service_country <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(total_weeks = n_distinct(week), .groups = "drop") |>
  filter(total_weeks > 200) |>
  arrange(total_weeks)

cease_date <- COUNTRY_TOP_10 |>
  filter(country_name == long_service_country$country_name[1]) |>
  summarise(last_week = max(week))


ARG <- "Argentina"


week_col <- if ("week" %in% names(COUNTRY_TOP_10)) "week" else
            if ("week_start" %in% names(COUNTRY_TOP_10)) "week_start" else
            stop("COUNTRY_TOP_10  week ")

argentina_films <- COUNTRY_TOP_10 |>
  filter(
    str_to_lower(country_name) == str_to_lower(ARG),
    str_detect(category, regex("\\bFilms\\b", ignore_case = TRUE))
  ) |>
  group_by(show_title) |>
  summarise(
    weeks_in_argentina = n_distinct(.data[[week_col]]),
    .groups = "drop"
  ) |>
  arrange(desc(weeks_in_argentina))


wk_gt <- if ("week" %in% names(GLOBAL_TOP_10)) "week" else
         if ("week_start" %in% names(GLOBAL_TOP_10)) "week_start" else
         stop("GLOBAL_TOP_10  week ")

GT_hours <- GLOBAL_TOP_10 |>
  transmute(
    show_title  = str_squish(show_title),
    week_date   = as.Date(.data[[wk_gt]]),
    global_hours = as.numeric(weekly_hours_viewed)
  )

ARG_weekly <- COUNTRY_TOP_10 |>
  filter(str_to_lower(country_name) == str_to_lower(ARG)) |>
  transmute(
    show_title = str_squish(show_title),
    week_date  = as.Date(.data[[week_col]])
  ) |>
  left_join(GT_hours, by = c("show_title","week_date")) |>
  mutate(global_hours = coalesce(global_hours, 0))


top3_titles <- ARG_weekly |>
  group_by(show_title) |>
  summarise(
    total_hours = sum(global_hours, na.rm = TRUE),
    total_weeks = n_distinct(week_date),
    .groups = "drop"
  ) |>
  arrange(desc(total_hours)) |>
  slice_head(n = 3)


head(argentina_films, 10)
top3_titles

```
**`r long_service_country$country_name[1]`** is the country with the longest Netflix service duration. As of **`r cease_date$last_week`**, viewing on Netflix remains robust with sustained momentum among headlining titles. By cumulative viewing, Argentina’s Top 3 are **`r top3_titles$show_title[1]`**,**`r top3_titles$show_title[2]`**, and **`r top3_titles$show_title[3]`**. The Argentine market remains healthy, with headline title popularity steadily rising.